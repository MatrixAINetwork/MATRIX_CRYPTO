## 附录A 组合公钥算法示例



在此附录中整数值以16进制表示，左边为高位，右边为低位。

本附录选用SM3算法给出的密码杂凑函数，其输入是长度小于$2^{64}$的消息比特串，其输出是长度为256比特的杂凑值，记为$H_{256}()$。

选择GM规定的椭圆曲线参数作为椭圆曲线参数。



本文以十六进制表示二进制数据

对于大整数，我们以十六进制表示大整数







### 主密钥

这里我们采用64字节的主密钥，至少为2块。

第一个值是seed值，这个值应该是一个二进制的值，我们还是

```
12:34:56:78:90:AA:BB:CC:DD:EE:FF
```



### 公开参数

第三部分，对应的公钥，这里我们应该定义一下公钥的表示方式，因为每个公钥都比较长，因此我们也应该提供压缩的公钥表示方式。这里要看看SM2是怎么定义的。

这个怎么表示呢？我们也不知道啊。

这里我们就把所有的整数给展示出来好了，用0x04作为前缀



### 映射$H_Z()$

这个映射函数是基于SM3的，我们要将一个ID值映射为n个随机数，每个随机数的值域在某个范围内。这个可以吗？



这里我们要把一个ID映射为整数，我们要求ID的格式是什么呢。



然后我们生成的是一组系数，这个系数的结果是什么呢？





### 用户私钥





作为用户A具有长度为$entlen_A$比特的可辨别标识$ID_A$，记$ENTL_A$是由整数$entlen_A$转换而成的两个字节。用户的可辨别标识为$ENTL_A \| ID_A$

alice@oscca.gov.cn

```
90ALICE@OSCCA.GOV.CN
```





### 用户公钥



用户的公钥为$a_0 P_0 + a_1 P_1 + … + a_{k-1}P_{k-1}$

结果为：我们以十六进制表示大整数

我们用(x, y)

表示椭圆曲线上的









